---
layout: post
title: ã€ç®—æ³•ã€‘æ”¯é…æ ‘
subtitle: 
date: 2020-03-11 00:00:00
author: fpdqwq
header-img: /img/home.png
mathjax: true
catalog: true
tags: ç®—æ³•
public: true
---

## å‰è¨€

* æœ¬æ–‡ç« å–æè‡ª[æ­¤ç¯‡](https://blog.csdn.net/qq_39972971/article/details/82382169)åšå®¢ï¼Œä»¥åŠæç…œä¸œçš„ã€Šå›¾è¿é€šæ€§è‹¥å¹²é—®é¢˜æ¢è®¨ã€‹ã€‚
* ç”±äºæ”¯é…æ ‘çš„ $Lengauer-Tarjan$ ç®—æ³•æ¶‰åŠåˆ°è¾ƒå¤šæ€§è´¨å’Œå¼•ç†çš„è¯æ˜ï¼Œå®¹æ˜“é—å¿˜ï¼Œæ‰€ä»¥ä½œè€…åœ¨è¿™é‡ŒæŠŠè¯æ˜çš„å¤§è‡´æ¡†æ¶æ•´ç†å‡ºæ¥ã€‚
* åœ¨ä¸‹æ–‡ä¸­ï¼Œä¸å¦¨å¯¹å›¾é‡æ ‡å·ï¼Œä½¿å¾— $u=dfn_u$ â€”â€” å³ä¸‹æ–‡ä¸­ï¼Œå¯¹ä¸¤ä¸ªç‚¹è¿›è¡Œæ¯”è¾ƒå®è´¨ä¸Šæ˜¯å¯¹å…¶ dfsåº è¿›è¡Œæ¯”è¾ƒã€‚

## æ”¯é…æ ‘

* æµå›¾ (Flow Graph)ï¼šè‹¥æœ‰å‘å›¾ $G$ ä¸­å­˜åœ¨ä¸€ç‚¹ $r$ï¼Œä» $r$ å‡ºå‘å¯ä»¥åˆ°è¾¾ $G$ ä¸­æ‰€æœ‰çš„ç‚¹ï¼Œåˆ™ç§° $G$ æ˜¯ Flow Graphï¼Œè®°ä¸º $(G,r)$ã€‚
* å¯¹å›¾ä¸­çš„è¾¹ $\langle u, v \rangle$ è¿›è¡Œåˆ†ç±»ï¼š
    1. æ ‘è¾¹ï¼š $u<v$
    2. å‰å‘è¾¹ï¼š $u<v$
    3. åå‘è¾¹ï¼š $u>v$
    4. æ¨ªå‰è¾¹ï¼š $u>v$

* æ”¯é…ç‚¹ï¼šè‹¥åœ¨ $(G,r)$ ä¸­ä» $r$ åˆ° $u$ çš„è·¯å¾„ä¸€å®šç»è¿‡ç‚¹ $v$ ï¼Œåˆ™ç§° $v$ æ˜¯ $u$ çš„æ”¯é…ç‚¹ï¼Œè®°ä¸º$v\ dom\ u$ã€‚
* æœ€è¿‘æ”¯é…ç‚¹ï¼šèŠ‚ç‚¹ $u$ çš„å¿…ç»ç‚¹é›†åˆ $dom(u)$ ä¸­ï¼Œé™¤ç‚¹ $u$ å¤–ï¼Œè¢«æ‰€æœ‰å…¶å®ƒç‚¹æ”¯é…çš„ç‚¹ $v$ï¼Œç§°ä½œ $u$ çš„æœ€è¿‘æ”¯é…ç‚¹ï¼Œè®°ä½œ $idom(u)$ã€‚
    * å®šç†1ï¼šé™¤äº†æºç‚¹çš„ç‚¹å‡å­˜åœ¨å”¯ä¸€çš„æœ€è¿‘æ”¯é…ç‚¹ã€‚

* æ”¯é…æ ‘ï¼šæ¯ä¸ªç‚¹å‘å…¶æœ€è¿‘æ”¯é…ç‚¹è¿è¾¹ï¼Œå¾—åˆ°çš„æ ‘ã€‚

### DAG çš„æ”¯é…æ ‘æ±‚è§£

* è®°ç‚¹ $u$ çš„å‰é©±èŠ‚ç‚¹é›†åˆä¸º $prev(u)$ï¼Œåˆ™ $dom(u) = \{u\} \cup \bigcap_{w\in prev(u)}{dom(w)}$
* åœ¨ DAG ä¸­ï¼ŒæŒ‰ç…§æ‹“æ‰‘åºæ±‚è§£ï¼›æ ¹æ®ä¸Šå¼ï¼Œæ¯ä¸ªç‚¹çš„ $idom$ ä¸ºå…¶æ‰€æœ‰å‰é©±çš„ $idom$ çš„ LCAã€‚
    * å¤æ‚åº¦ $O(mlogn)$ã€‚

* åœ¨æœ‰ç¯å›¾ä¸­ï¼Œå¯ä»¥æ¯æ¬¡åˆ æ‰ä¸€ä¸ªç‚¹ï¼Œè·‘ä¸€é dfsï¼Œè®°å½•å“ªäº›ç‚¹å˜å¾—ä¸å¯è¾¾ï¼Œä»¥æ±‚å‡ºå…¶æ”¯é…ç‚¹é›†åˆã€‚
    * å¤æ‚åº¦ $O(nm)$ã€‚

### L-T ç®—æ³•

* å®šä¹‰ï¼šåŠæ”¯é…ç‚¹ï¼šå¯¹äº $u \ne r$ï¼Œå®šä¹‰å…¶åŠæ”¯é…ç‚¹ä¸º

$$
sdom(u) = min\{w|\exists(v_0, ..., v_k), k \ge 1 , v_0 = w, v_k = u, \forall 1\leq i< k, v_i>u \}
$$

* * å³ï¼šåªç»è¿‡ $>u$ çš„ç‚¹å¯ä»¥åˆ°è¾¾ç‚¹ $u$ çš„æ‰€æœ‰ç‚¹ä¸­çš„æœ€å°ç‚¹ã€‚

* å¼•ç†1ï¼ˆè·¯å¾„å¼•ç†ï¼‰ï¼šå¦‚æœä¸¤ä¸ªç‚¹ $u, v$ æ»¡è¶³ $u < v$ï¼Œåˆ™ä»»æ„ä» $u$ åˆ° $v$ çš„è·¯å¾„ç»è¿‡å®ƒä»¬çš„å…¬å…±ç¥–å…ˆã€‚
    * è¯æ˜ï¼šå¦‚æœä¸èƒ½ç»è¿‡å…¬å…±ç¥–å…ˆï¼Œå¯ç”¨çš„è¾¹å°±åªå‰©ä¸‹æ¨ªå‰è¾¹ï¼›ä½†æ¨ªå‰è¾¹ä¸€å®šæ˜¯ä»å¤§åˆ°å°ï¼ŒçŸ›ç›¾ã€‚
* å¼•ç†2ï¼š$idom(u)$ æ˜¯ $u$ çš„ç¥–å…ˆï¼Œå³ $ idom(u) \in asc(u) $ã€‚
* å¼•ç†3ï¼š$sdom(u)$ æ˜¯ $u$ çš„ç¥–å…ˆã€‚ç”±å¼•ç†1å¯è¯ã€‚
* å¼•ç†4ï¼š$idom(u)$ æ˜¯ $sdom(u)$ çš„ç¥–å…ˆï¼Œæˆ–äºŒè€…ç›¸ç­‰ã€‚
* å¼•ç†5ï¼šä»»æ„ $idom(u)$ åˆ° $u$ çš„è·¯å¾„ä¸¤ä¸¤ä¸äº¤ï¼ˆäºéç«¯ç‚¹çš„ç‚¹ï¼‰ã€‚

* å®šç†2ï¼šè‹¥å¯¹æ‰€æœ‰æ»¡è¶³ $u \leq w < sdom(u)$ ä¸” $sdom(u) \in asc(w) $ çš„ç‚¹ $w$ï¼Œå‡æœ‰ï¼š$$sdom(w) \geq sdom(u) \to idom(u) = sdom(u)$$
    * ç”±å¼•ç†4å¯è¯ã€‚

* å®šç†3ï¼šè‹¥å¯¹æœ€å°çš„æ»¡è¶³ $u \leq w < sdom(u)$ ä¸” $sdom(u) \in asc(w) $ çš„ç‚¹ $w$ï¼Œå‡æœ‰ï¼š$$sdom(w) \leq sdom(u) \to idom(u) = idom(w)$$
    * ç”±å¼•ç†4, 5å¯è¯

* æ¨è®ºï¼ˆå¿…ç»ç‚¹å®šç†ï¼‰ï¼šå¯¹æœ€å°çš„æ»¡è¶³ $u \leq w < sdom(u)$ ä¸” $sdom(u)$ æ˜¯ $w$ çš„ç¥–å…ˆçš„ç‚¹ $w$ï¼Œæœ‰ï¼š
    
    $$idom(u)= \begin{cases} sdom(u), &sdom(w) = sdom(u)\\ idom(w), &sdom(w) < sdom(u) \end{cases}$$
* å®šç†4ï¼ˆåŠå¿…ç»ç‚¹å®šç†ï¼‰ï¼š
    
    $$\begin{array}{cc} sdom(u) = \min \{ w|w\in prev(u), w < u \} \cup \\ \{ sdom(v)|w \in prev(u), w > v > u, v \in asc(w) \} \end{array}$$
    * PPTä¸­çš„è¡¨è¿°å¦‚ä¸‹ï¼š
        
        > å¯¹äºğºä¸­çš„ä¸€ç‚¹ğ‘¦ï¼Œè€ƒè™‘æ‰€æœ‰ğ‘¥âˆˆğ‘ğ‘Ÿğ‘’(ğ‘¦)ï¼Œå®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡ğ‘¡ğ‘’ğ‘šğ‘=+INFã€‚  
        > è‹¥ğ‘‘ğ‘“ğ‘›\[ğ‘¥\]<ğ‘‘ğ‘“ğ‘›\[ğ‘¦\]ï¼Œğ‘¡ğ‘’ğ‘šğ‘=min(ğ‘¡ğ‘’ğ‘šğ‘,ğ‘‘ğ‘“ğ‘›\[ğ‘¥\])ã€‚  
        > è‹¥ğ‘‘ğ‘“ğ‘›\[ğ‘¥\]>ğ‘‘ğ‘“ğ‘›\[ğ‘¦\]ï¼Œå¯¹ä»»æ„ğ‘¥åœ¨ğ‘‡ä¸­çš„ç¥–å…ˆğ‘§ï¼Œæ»¡è¶³ğ‘‘ğ‘“ğ‘›\[ğ‘§\]>ğ‘‘ğ‘“ğ‘›\[ğ‘¦\]æ—¶ï¼Œ  
        > æœ‰ğ‘¡ğ‘’ğ‘šğ‘=min(ğ‘¡ğ‘’ğ‘šğ‘,ğ‘‘ğ‘“ğ‘›\[ğ‘ ğ‘’ğ‘šğ‘–\[ğ‘§\]\])ã€‚  
        > ğ‘ ğ‘’ğ‘šğ‘–\[ğ‘¦\]=ğ‘–ğ‘‘\[ğ‘¡ğ‘’ğ‘šğ‘\]ã€‚å³åœ¨ä¸Šè¿°æ‰€æœ‰å¯èƒ½æƒ…å†µä¸­å–ğ‘‘ğ‘“ğ‘›å€¼æœ€å°çš„ä¸€ç§ï¼Œå°±æ˜¯ğ‘¦çš„åŠå¿…ç»ç‚¹ã€‚
        

### ä»£ç å®ç°

* æœ‰äº†å¿…ç»ç‚¹å®šç†å’ŒåŠå¿…ç»ç‚¹å®šç†ï¼Œå°±å¯ä»¥è¿›è¡Œä»£ç å®ç°äº†ã€‚æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š
    1. å¤„ç†å‡º DFS æ ‘ï¼›
    2. åˆ©ç”¨åŠå¿…ç»ç‚¹å®šç†ï¼ŒæŒ‰ç…§ DFSåº çš„é€†åºæ±‚å‡ºæ¯ä¸ªç‚¹çš„ sdomï¼›
    3. åˆ©ç”¨å¿…ç»ç‚¹å®šç†ï¼Œæ±‚å‡º idom == sdom çš„ç‚¹ï¼›
    4. ç”±ç¬¬ 3 æ­¥ä¸­çš„ idom æ±‚å‡ºæ‰€æœ‰ç‚¹çš„ idomã€‚

* ä»£ç å®ç°ç»†èŠ‚å¦‚ä¸‹ï¼š
    
    1. å°†æ¯ä¸ªç‚¹çš„ sdom åˆå§‹åŒ–ä¸ºè‡ªèº«ã€‚
    2. åœ¨ç¬¬ 2 æ­¥ä¸­ï¼Œå¯¹æ¯ä¸ªç‚¹ç»´æŠ¤ home å€¼ï¼Œè¡¨ç¤ºåŠå¿…ç»ç‚¹å®šç†ä¸­æ»¡è¶³è¦æ±‚çš„ sdom æœ€å°å€¼ç‚¹ã€‚
    3. åˆ©ç”¨å¸¦æƒå¹¶æŸ¥é›†ç®—æ³•ï¼ŒæŒ‰dfsåºçš„é€†åºæ¯æ¬¡å°†æŸç‚¹ä¸çˆ¶èŠ‚ç‚¹åˆå¹¶ï¼Œä»¥å¤„ç†åŠå¿…ç»ç‚¹å®šç†ä¸­ $v > u $ çš„é™åˆ¶ï¼ŒåŒæ—¶ç»´æŠ¤ home å€¼ï¼ˆå€¼ä¸ºè¯¥ç‚¹åˆ°å…¶é›†åˆçš„æ ¹èŠ‚ç‚¹è·¯å¾„ä¸Š sdom æœ€å°è€…ï¼‰ã€‚
    4. ç¬¬ 2, 3 æ­¥ä¸€å¹¶å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ¯ä¸ªç‚¹çš„ home å€¼ï¼ˆæŸ¥è¯¢ç»“æœï¼‰ä¸´æ—¶è®°å½•åˆ° idom ä¸­ï¼Œä»¥ä¾¿ä¸‹ä¸€æ­¥ä½¿ç”¨ã€‚
    5. ç”±äºæˆ‘ä»¬è®°å½•çš„æ˜¯ sdom(u) çš„æœ€å°å€¼ç‚¹è€Œéæœ€å°å€¼ï¼Œæ‰€ä»¥ç®—æ³•ç¬¬ 4 æ­¥ä¸­ï¼Œåº”å½“åˆ¤æ–­äºŒè€…çš„ sdom ä¹‹é—´çš„å¤§å°å…³ç³»ï¼Œè€Œéæ¯”è¾ƒæœ¬èº«çš„å¤§å°å…³ç³»ï¼ˆè§ä»£ç ï¼‰ã€‚
* ç®—æ³•å¤æ‚åº¦$O(N\log N)$ã€‚
    

#### ä»£ç 

> [HDU4694: Important Sisters](http://acm.hdu.edu.cn/showproblem.php?pid=4694)

```cpp
#include <bits/stdc++.h>

using namespace std;

const int N = 1e5 + 5;

int n, m, S;
int dfn[N], ID[N], fa[N], timer;
int p[N], semi[N], idom[N], home[N];
vector <int> E[N], E_rev[N], Vs[N];
int res[N];



int find(int x) {
    if(p[x] < 0) return x;
    int px = find(p[x]);
    home[x] = getmin(home[x], home[p[x]]);
    return p[x] = px;
}

inline void onion(int x, int y) {
    x = find(x), y = find(y);
    if(x == y) return ;
    home[x] = getmin(home[x], home[y]);
    p[x] = y;
}

void dfs(int u, int pre) {
    dfn[u] = ++timer;
    ID[timer] = u;
    fa[u] = pre;
    for(auto v: E[u]) if(dfn[v] == 0) dfs(v, u);
}

void clear() {
    for(int i = 1; i <= n; i++) {
        E[i].clear();
        E_rev[i].clear();
        Vs[i].clear();
        idom[i] = fa[i] = home[i] = 0;
    }
}



void init() {
    int u, v;
    for(int i = 1; i <= m; i++) {
        scanf("%d%d", &u, &v);
        E[u].push_back(v);
        E_rev[v].push_back(u);
    }
    S = n;
    timer = 0;
    for(int i = 1; i <= n; i++) dfn[i] = 0, p[i] = -1, semi[i] = home[i] = i;
    dfs(S, 0);
    for(int i = timer; i >= 2; i--) {
        u = ID[i];
        for(auto v: E_rev[u])
            if(dfn[v]) semi[u] = semi[getmin(u, gethome(v))]; //key1 æ³¨æ„è¿™é‡Œçš„å†™æ³•
        Vs[semi[u]].push_back(u);
        for(auto v: Vs[fa[u]]) idom[v] = gethome(v); //key2
        Vs[fa[u]].clear();
        onion(u, fa[u]);
    }
    res[S] = S;
    for(int i = 2; i <= timer; i++) {
        u = ID[i];
        if(semi[idom[u]] == semi[u]) idom[u] = semi[u]; //key3 æ³¨æ„æ˜¯semiç›¸ç­‰ï¼Œä¸ä¸€å®šæ˜¯idom[u]==u
        else idom[u] = idom[idom[u]]; //key4
        res[u] = res[idom[u]] + u;
    }
    for(int i = 1; i <= n; i++) {
        if(dfn[i] == 0) printf("0");
        else printf("%d", res[i]); 
        if(i == n) printf("\n");
        else printf(" ");
    }
    clear();
}

int main() {
    while(scanf("%d%d", &n, &m) != EOF) init();
    return 0;
}
```

Author : fpdqwq

![37002035_p0.png](https://i.loli.net/2020/03/06/jdF9HMvPSh1YRkc.png)
